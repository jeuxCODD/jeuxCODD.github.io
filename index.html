<html>
    <head>
        <meta charset = "UTF8">
        <link rel="stylesheet" href="css/styleIndex.css" />
        <title>DemieVieMorue</title>
    </head>
    
    <body>
        <div class=topnav>
            <h1>
                <!--Titre-->
                La demie vie d'une morue
                <img src="images/logo.png" style="height: 45px; width: 50px; offset-left: 30px; align-image: right;" />
                <a href="parametretn.html">
                    <img class="parametres" img src="images/gear.png" style="height: 55px; width: 55px; offset-left: 30px; align-image: right;"/>
                </a>
            </h1>
        </div>
        <!--Description du jeu-->
        <div class="messageDescription">
            <p class="messageText">
                Une morue est prise au dessus d'un produit chimique mortelle.
                Tu dois sauver la morue par balancer les bases et les acides jusqu'à le PH 
                qui est sauf pour les poissons. Les morues sont une èspèce de poissons en danger,
                donc tu peux mettre une donation envers les morues atlantiques sur le site web à la gauche.
            </p>
        </div>
        <!--Page donation-->
        <div class="donationCote">
             <iframe src="https://davidsuzuki.org/wp-content/uploads/2019/02/left-off-the-list-profile-of-marine-and-northern-species-denied-listing.pdf#page=15">
             </iframe>
            
        </div>
        <div class="input">
            <form>
                <!--Boîte type text pour nommer le Morue-->
                <input id="nommerMorue" type="text" placeholder="Nommer Votre Morue">
                <br><br>
                <!--Boîte submit pour entrez dans le jeu-->
                <input type="button" value="Entrez dans le jeu" onclick="nomCheck()">
            </form>
        </div>
        <script>
        /* le code suivant est un test. La fonction pour crée un liste à partire d'un fichier à été pris de:
        https://stackoverflow.com/questions/67572638/read-a-text-file-and-save-it-into-a-list-javascript
        et le blacklist à partire d'un liste à été crée par moi et le liste est tiré de http://www.bannedwordlist.com/ 
        le code initiale est le suivant et a completement été crée par owen:
             //Fonction qui vérifie si le nom a plus que 2 caractères. Si oui, tu entre au niveau 1
            //si non, il y a un alert et du doit remettre le nom
            function nomCheck() {
                let nomValue = document.getElementById("nommerMorue").value
                if (nomValue.length <= 25 || nomValue.toLowerCase == "tung tung tung tung tung tung tung sahur"){
                    window.localStorage.setItem('nom-morue', nomValue);
                    window.location.assign("lvl1.html");
                } else {
                    alert("Votre nom doit être moins que 25 caractères")
                }
        le tout est mis ensemble
        par un certain "chatGPT" */
            
          // 1) Prepare an array to hold your blacklist.

          let blacklist = [];
    
          // 2) On page load, fetch the remote word‑list and split into lines.
    
          (async function loadBlacklist() {
    
            try {
    
              const res = await fetch("http://www.bannedwordlist.com/lists/swearWords.txt");
    
              if (!res.ok) throw new Error(res.statusText);
    
              const text = await res.text();
    
              blacklist = text.split(/\r\n|\n/).map(w => w.toLowerCase());
    
            } catch (e) {
    
              console.warn("Could not load blacklist:", e);
    
            }
    
          })();
    
    
    
          // 3) Your filter function
    
          function filterBlacklistedWords(text, blacklist) {
    
            return text
    
              .split(/\s+/)
    
              .map(word => {
    
                const lower = word.toLowerCase();
    
                return blacklist.includes(lower)
    
                  ? "*".repeat(word.length)
    
                  : word;
    
              })
    
              .join(" ");
    
          }
    
    
    
          // 4) The name‑check function become async so we can await the blacklist
    
          async function nomCheck() {
    
            const inputEl = document.getElementById("nommerMorue");
    
            let nomValue = inputEl.value.trim();
    
    
    
            // wait for blacklist to load (if it isn’t already)
    
            if (blacklist.length === 0) {
    
              // a simple retry; you could do better with a Promise
    
              await new Promise(r => setTimeout(r, 200));
    
            }
    
    
    
            // apply your existing length check
    
            if (nomValue.length > 0 && nomValue.length < 25) {
    
              // filter out any forbidden words
    
              const filtered = filterBlacklistedWords(nomValue, blacklist);
    
    
    
              // store the *filtered* version
    
              window.localStorage.setItem("nom-morue", filtered);
    
    
    
              // go to level 1
    
              window.location.assign("lvl1.html");
    
            } else {
    
              alert("Votre nom doit être entre 1 et 24 caractères.");
    
    
                    }
                    
                        
                }

        </script>
    </body>
</html>
